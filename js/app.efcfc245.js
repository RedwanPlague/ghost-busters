(function(t){function s(s){for(var e,r,a=s[0],l=s[1],h=s[2],c=0,g=[];c<a.length;c++)r=a[c],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&g.push(n[r][0]),n[r]=0;for(e in l)Object.prototype.hasOwnProperty.call(l,e)&&(t[e]=l[e]);u&&u(s);while(g.length)g.shift()();return o.push.apply(o,h||[]),i()}function i(){for(var t,s=0;s<o.length;s++){for(var i=o[s],e=!0,a=1;a<i.length;a++){var l=i[a];0!==n[l]&&(e=!1)}e&&(o.splice(s--,1),t=r(r.s=i[0]))}return t}var e={},n={app:0},o=[];function r(s){if(e[s])return e[s].exports;var i=e[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,s,i){r.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:i})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,s){if(1&s&&(t=r(t)),8&s)return t;if(4&s&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var e in t)r.d(i,e,function(s){return t[s]}.bind(null,e));return i},r.n=function(t){var s=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(s,"a",s),s},r.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},r.p="/ghost-busters/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=s,a=a.slice();for(var h=0;h<a.length;h++)s(a[h]);var u=l;o.push([0,"chunk-vendors"]),i()})({0:function(t,s,i){t.exports=i("56d7")},"034f":function(t,s,i){"use strict";i("85ec")},"48d8":function(t,s,i){},"56d7":function(t,s,i){"use strict";i.r(s);i("e260"),i("e6cf"),i("cca6"),i("a79d");var e=i("2b0e"),n=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{attrs:{id:"app"}},[i("Game")],1)},o=[],r=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",[i("label",[t._v("rows: "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.rows.string,expression:"rows.string"}],attrs:{name:"rows",type:"number",min:t.rows.min,max:t.rows.max},domProps:{value:t.rows.string},on:{input:[function(s){s.target.composing||t.$set(t.rows,"string",s.target.value)},function(s){return t.handleInputChange(t.rows)}]}})]),i("label",[t._v("cols: "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.cols.string,expression:"cols.string"}],attrs:{name:"cols",type:"number",min:t.cols.min,max:t.cols.max},domProps:{value:t.cols.string},on:{input:[function(s){s.target.composing||t.$set(t.cols,"string",s.target.value)},function(s){return t.handleInputChange(t.cols)}]}})]),i("label",[t._v("ghosts: "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.ghosts.string,expression:"ghosts.string"}],attrs:{name:"ghosts",type:"number",min:t.ghosts.min,max:t.ghosts.max},domProps:{value:t.ghosts.string},on:{input:[function(s){s.target.composing||t.$set(t.ghosts,"string",s.target.value)},function(s){return t.handleInputChange(t.ghosts)}]}})]),i("label",[t._v("near: "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.near.string,expression:"near.string"}],attrs:{name:"near",type:"number",min:t.near.min,max:t.near.max},domProps:{value:t.near.string},on:{input:[function(s){s.target.composing||t.$set(t.near,"string",s.target.value)},function(s){return t.handleInputChange(t.near)}]}})]),i("label",[t._v("far: "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.far.string,expression:"far.string"}],attrs:{name:"far",type:"number",min:t.far.min,max:t.far.max},domProps:{value:t.far.string},on:{input:[function(s){s.target.composing||t.$set(t.far,"string",s.target.value)},function(s){return t.handleInputChange(t.far)}]}})]),i("label",[t._v("catch: "),i("select",{directives:[{name:"model",rawName:"v-model",value:t.allAtOnce,expression:"allAtOnce"}],staticStyle:{"font-family":"monospace"},on:{change:function(s){var i=Array.prototype.filter.call(s.target.options,(function(t){return t.selected})).map((function(t){var s="_value"in t?t._value:t.value;return s}));t.allAtOnce=s.target.multiple?i:i[0]}}},[i("option",{domProps:{value:!0}},[t._v("all ghosts in a cell at once")]),i("option",{domProps:{value:!1}},[t._v("one ghost at a time")])])]),i("Board",{attrs:{rows:t.rows.value,cols:t.cols.value,ghosts:t.ghosts.value,splits:[t.near.value,t.near.value+t.far.value],"all-at-once":t.allAtOnce}})],1)},a=[],l=(i("d3b7"),i("25f0"),function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{attrs:{id:"holder"}},[i("div",[i("div",{attrs:{id:"caught"}},[i("span",{staticStyle:{float:"left",position:"relative",left:"100px"}},[t._v("Caught Ghosts: "+t._s(t.ghosts-t.ghostPositions.length))]),i("span",{staticStyle:{float:"right",position:"relative",right:"100px"}},[t._v("Attempts: "+t._s(t.attempts))])]),i("table",{staticClass:"center"},t._l(t.probabilities,(function(s,e){return i("tr",{key:e},t._l(s,(function(s,n){return i("td",{key:n,style:t.cellStyles(e,n,s),on:{click:function(s){return t.senseCell(e,n)}}},[t.tryResult>0&&e===t.lastClicked.x&&n===t.lastClicked.y?i("span",[1===t.tryResult?i("span",{style:{color:"green",fontSize:(t.allAtOnce?25:30)+"px"}},[t._v(" ✔"),t.allAtOnce?i("span",[t._v(t._s(t.caughtCount))]):t._e()]):2===t.tryResult?i("span",{staticStyle:{color:"red","font-size":"30px"}},[t._v(" ✗ ")]):t._e()]):i("span",[t._v(" "+t._s((100*s).toFixed(2))+" ")])])})),0)})),0)]),0===t.ghostPositions.length?i("div",{attrs:{id:"done"}},[t._v(" "+t._s(1===t.ghosts?"Ghost":"All ghosts")+" caught, you can sleep at peace now. Yay! ")]):t._e(),i("div",{staticClass:"center",staticStyle:{width:"fit-content"}},[t.ghostPositions.length>0?i("button",{on:{click:t.advanceTime}},[t._v("Advance Time")]):t._e(),t.ghostPositions.length>0?i("button",{on:{click:t.reveal}},[t._v(t._s(t.revealed?"Hide":"Reveal"))]):t._e(),t.ghostPositions.length>0?i("button",{on:{click:t.catchMode}},[t._v(t._s(t.catching?"Find":"Catch"))]):t._e()]),t.ghostPositions.length>0&&t.history.length>0?i("button",{attrs:{id:"undo"},on:{click:t.popHistory}},[t._v("Undo")]):t._e()])}),h=[],u=(i("cb29"),i("4de4"),i("7db0"),i("d81d"),i("13d5"),i("a434"),i("a9e3"),i("b85c")),c={name:"Board",props:{rows:{type:Number,default:9},cols:{type:Number,default:9},ghosts:{type:Number,default:1},splits:{type:Array,default:function(){return[2,7]}},allAtOnce:{type:Boolean,default:!1}},data:function(){return{bgColors:["red","orange","green"],fontColors:["white","black","white"],cornerProbabilities:[.48,.48,.48,.48,.036,.036,.036,.036,.004],sideProbabilities:[.32,.32,.32,.32,.018,.018,.018,.018,.004],midProbabilities:[.24,.24,.24,.24,.009,.009,.009,.009,.004],dx:[-1,1,0,0,1,1,-1,-1,0],dy:[0,0,1,-1,1,-1,1,-1,0],sensorAccuracies:[[1,0,0],[0,1,0],[0,0,1]],probabilities:[[]],ghostPositions:[],tryResult:0,attempts:0,caughtCount:0,lastClicked:{x:-1,y:-1},currentlySensed:[],revealed:!1,catching:!1,history:[]}},methods:{initialize:function(){var t=this,s=this.rows*this.cols,i=this.ghosts/s;this.probabilities=Array(this.rows).fill(i).map((function(s){return Array(t.cols).fill(s)})),this.ghostPositions=Array(this.ghosts);for(var e=0;e<this.ghosts;e++)this.ghostPositions[e]=this.getRandomCell();this.tryResult=0,this.attempts=0,this.lastClicked={x:-1,y:-1},this.currentlySensed=[],this.catching=!1,this.history=[]},pushHistory:function(){this.history.length>=100&&this.history.splice(0,1),this.history.push(JSON.parse(JSON.stringify({probabilities:this.probabilities,ghostPositions:this.ghostPositions,currentlySensed:this.currentlySensed,attempts:this.attempts})))},popHistory:function(){var t=this.history.pop();this.probabilities=t.probabilities,this.ghostPositions=t.ghostPositions,this.currentlySensed=t.currentlySensed,this.attempts=t.attempts},cellStyles:function(t,s,i){if(this.tryResult>0&&t===this.lastClicked.x&&s===this.lastClicked.y)return{backgroundColor:"white"};if(!this.catching&&this.isCurrentlySensed(t,s)){var e=this.currentlySensed.find((function(i){return t===i.x&&s===i.y})).distClass;return{backgroundColor:this.bgColors[e],color:this.fontColors[e]}}if(this.revealed){var n=this.getDistClass(this.closestGhostDistanceFromCell(t,s));return{backgroundColor:this.bgColors[n],color:this.fontColors[n]}}var o=0===this.ghostPositions.length?0:Math.sqrt(i/this.ghostPositions.length);return{backgroundColor:"rgba(100, 0, 255, ".concat(o,")"),color:o>.6?"white":"black"}},withinBoard:function(t,s){return t>=0&&t<this.rows&&s>=0&&s<this.cols},getRandomCell:function(){return{x:Math.floor(Math.random()*this.rows),y:Math.floor(Math.random()*this.cols)}},getDistClass:function(t){for(var s=0;s<this.splits.length;s++)if(t<=this.splits[s])return s;return this.splits.length},getDistClassCount:function(t,s,i){for(var e=0,n=0;n<this.rows;n++)for(var o=0;o<this.cols;o++)this.getDistClass(Math.abs(t-n)+Math.abs(s-o))===i&&e++;return e},ghostCountOfCell:function(t,s){return this.ghostPositions.reduce((function(i,e){return t===e.x&&s===e.y?++i:i}),0)},closestGhostDistanceFromCell:function(t,s){return this.ghostPositions.reduce((function(i,e){var n=e.x,o=e.y;return Math.min(i,Math.abs(n-t)+Math.abs(o-s))}),this.rows+this.cols)},isCornerCell:function(t,s){return(0===t||t===this.rows-1)&&(0===s||s===this.cols-1)},isMidCell:function(t,s){return t>0&&t<this.rows-1&&s>0&&s<this.cols-1},isSideCell:function(t,s){return!this.isCornerCell(t,s)&&!this.isMidCell(t,s)},getMoveProbabilities:function(t,s){return this.isCornerCell(t,s)?this.cornerProbabilities:this.isSideCell(t,s)?this.sideProbabilities:this.midProbabilities},updateArray:function(t,s,i,e){this.withinBoard(s,i)&&(t[s][i]+=e)},spreadSelf:function(t,s,i,e,n){for(var o=0;o<this.dx.length;o++)this.updateArray(t,s+this.dx[o],i+this.dy[o],e*n[o])},advanceProbabilities:function(){for(var t=this,s=Array(this.rows).fill(0).map((function(s){return Array(t.cols).fill(s)})),i=0;i<this.rows;i++)for(var e=0;e<this.cols;e++)this.spreadSelf(s,i,e,this.probabilities[i][e],this.getMoveProbabilities(i,e));this.probabilities=s},goRandomDirection:function(t){for(var s=t.x,i=t.y,e=this.getMoveProbabilities(s,i),n=Math.random(),o=0,r=0;r<this.dx.length;r++)if(this.withinBoard(s+this.dx[r],i+this.dy[r])&&(o+=e[r],n<o))return{x:s+this.dx[r],y:i+this.dy[r]};return{x:s,y:i}},verifySum:function(){for(var t=0,s=0;s<this.rows;s++)for(var i=0;i<this.cols;i++)t+=this.probabilities[s][i];Math.abs(t-this.ghostPositions.length)>1e-4&&console.log("sum error")},advanceGhosts:function(){for(var t=0;t<this.ghostPositions.length;t++)this.$set(this.ghostPositions,t,this.goRandomDirection(this.ghostPositions[t]))},advanceTime:function(){this.pushHistory(),this.currentlySensed=[],this.advanceProbabilities(),this.verifySum(),this.advanceGhosts()},updateCell:function(t,s,i){this.probabilities[t][s]=i,this.$set(this.probabilities,t,this.probabilities[t])},tryToCatch:function(t,s){var i=this;if(this.attempts++,this.caughtCount=this.ghostCountOfCell(t,s),this.caughtCount>0){if(this.allAtOnce||(this.caughtCount=1),this.currentlySensed=[],this.allAtOnce)this.ghostPositions=this.ghostPositions.filter((function(i){return t!==i.x||s!==i.y})),this.updateCell(t,s,0);else for(var e=0;e<this.ghostPositions.length;e++)if(this.ghostPositions[e].x===t&&this.ghostPositions[e].y===s){this.ghostPositions.splice(e,1);break}this.normalize(),0===this.ghostPositions.length&&(this.probabilities=Array(this.rows).fill(0).map((function(t){return Array(i.cols).fill(t)}))),this.tryResult=1,setTimeout((function(){i.tryResult=0}),1e3)}else this.updateCell(t,s,0),this.normalize(),this.tryResult=2,setTimeout((function(){i.tryResult=0}),500)},reWeight:function(t,s,i){for(var e=Array(this.bgColors.length),n=0;n<e.length;n++)e[n]=this.getDistClassCount(t,s,n);for(var o=this.rows*this.cols,r=Math.pow(o,this.ghostPositions.length),a=Math.pow(o-1,this.ghostPositions.length),l=r-a,h=Array(e.length),u=Array(e.length),c=0,g=0;g<e.length;g++){var f=Math.pow(o-c,this.ghostPositions.length),d=Math.pow(o-c-1,this.ghostPositions.length);u[g]=(f-d)/l,c+=e[g];var p=Math.pow(o-c,this.ghostPositions.length),v=Math.pow(o-c-1,this.ghostPositions.length);h[g]=(f-d-p+v)/l}for(var m=JSON.parse(JSON.stringify(this.probabilities)),b=0;b<this.rows;b++)for(var y=0;y<this.cols;y++){for(var C=this.getDistClass(Math.abs(t-b)+Math.abs(s-y)),w=u[C]*this.sensorAccuracies[C][i],P=0;P<C;P++)w+=h[P]*this.sensorAccuracies[P][i];m[b][y]*=w}this.probabilities=m},normalize:function(){var t=this.probabilities.reduce((function(t,s){return t+s.reduce((function(t,s){return t+s}),0)}),0);t/=this.ghostPositions.length;for(var s=JSON.parse(JSON.stringify(this.probabilities)),i=0;i<this.rows;i++)for(var e=0;e<this.cols;e++)s[i][e]/=t;this.probabilities=s},sense:function(t,s){for(var i=this.getDistClass(this.closestGhostDistanceFromCell(t,s)),e=Math.random(),n=0,o=this.sensorAccuracies[i],r=0;r<o.length;r++)if(n+=o[r],e<n)return r;return o[o.length-1]},senseCell:function(t,s){if(!(this.tryResult>0||0===this.ghostPositions.length))if(this.pushHistory(),this.lastClicked={x:t,y:s},this.catching)this.tryToCatch(t,s);else if(!this.isCurrentlySensed(t,s)){var i=this.sense(t,s);this.currentlySensed.push({x:t,y:s,distClass:i}),this.reWeight(t,s,i),this.normalize()}},isCurrentlySensed:function(t,s){var i,e=Object(u["a"])(this.currentlySensed);try{for(e.s();!(i=e.n()).done;){var n=i.value;if(t===n.x&&s===n.y)return!0}}catch(o){e.e(o)}finally{e.f()}return!1},reveal:function(){this.revealed=!this.revealed},catchMode:function(){this.catching=!this.catching}},watch:{rows:function(){this.initialize()},cols:function(){this.initialize()},ghosts:function(){this.initialize()},splits:function(){this.currentlySensed=[]}},created:function(){this.initialize()}},g=c,f=(i("d537"),i("2877")),d=Object(f["a"])(g,l,h,!1,null,"1a438f66",null),p=d.exports,v={name:"Game",components:{Board:p},data:function(){return{rows:{string:"9",value:9,min:1,max:10},cols:{string:"9",value:9,min:1,max:20},ghosts:{string:"1",value:1,min:1,max:10},near:{string:"2",value:2,min:0,max:3},far:{string:"3",value:3,min:0,max:5},allAtOnce:!1}},methods:{handleInputChange:function(t){if(""===t.string)this.$set(t,"value",t.min);else{var s=Math.max(t.min,Math.min(t.max,parseInt(t.string)));this.$set(t,"value",s),this.$set(t,"string",s.toString())}}}},m=v,b=(i("f76c"),Object(f["a"])(m,r,a,!1,null,"58b58acd",null)),y=b.exports,C={name:"App",components:{Game:y}},w=C,P=(i("034f"),Object(f["a"])(w,n,o,!1,null,null,null)),x=P.exports;e["a"].config.productionTip=!1,new e["a"]({render:function(t){return t(x)}}).$mount("#app")},"85ec":function(t,s,i){},9563:function(t,s,i){},d537:function(t,s,i){"use strict";i("48d8")},f76c:function(t,s,i){"use strict";i("9563")}});
//# sourceMappingURL=app.efcfc245.js.map
(function(t){function s(s){for(var i,r,a=s[0],l=s[1],h=s[2],c=0,g=[];c<a.length;c++)r=a[c],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&g.push(n[r][0]),n[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);u&&u(s);while(g.length)g.shift()();return o.push.apply(o,h||[]),e()}function e(){for(var t,s=0;s<o.length;s++){for(var e=o[s],i=!0,a=1;a<e.length;a++){var l=e[a];0!==n[l]&&(i=!1)}i&&(o.splice(s--,1),t=r(r.s=e[0]))}return t}var i={},n={app:0},o=[];function r(s){if(i[s])return i[s].exports;var e=i[s]={i:s,l:!1,exports:{}};return t[s].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=t,r.c=i,r.d=function(t,s,e){r.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:e})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,s){if(1&s&&(t=r(t)),8&s)return t;if(4&s&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var i in t)r.d(e,i,function(s){return t[s]}.bind(null,i));return e},r.n=function(t){var s=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(s,"a",s),s},r.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},r.p="/ghost-busters/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=s,a=a.slice();for(var h=0;h<a.length;h++)s(a[h]);var u=l;o.push([0,"chunk-vendors"]),e()})({0:function(t,s,e){t.exports=e("56d7")},"034f":function(t,s,e){"use strict";e("85ec")},"56d7":function(t,s,e){"use strict";e.r(s);e("e260"),e("e6cf"),e("cca6"),e("a79d");var i=e("2b0e"),n=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{attrs:{id:"app"}},[e("Game")],1)},o=[],r=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("label",[t._v("rows: "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.rows.string,expression:"rows.string"}],attrs:{name:"rows",type:"number",min:t.rows.min,max:t.rows.max},domProps:{value:t.rows.string},on:{input:[function(s){s.target.composing||t.$set(t.rows,"string",s.target.value)},function(s){return t.handleInputChange(t.rows)}]}})]),e("label",[t._v("cols: "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.cols.string,expression:"cols.string"}],attrs:{name:"cols",type:"number",min:t.cols.min,max:t.cols.max},domProps:{value:t.cols.string},on:{input:[function(s){s.target.composing||t.$set(t.cols,"string",s.target.value)},function(s){return t.handleInputChange(t.cols)}]}})]),e("label",[t._v("ghosts: "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.ghosts.string,expression:"ghosts.string"}],attrs:{name:"ghosts",type:"number",min:t.ghosts.min,max:t.ghosts.max},domProps:{value:t.ghosts.string},on:{input:[function(s){s.target.composing||t.$set(t.ghosts,"string",s.target.value)},function(s){return t.handleInputChange(t.ghosts)}]}})]),e("label",[t._v("near: "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.near.string,expression:"near.string"}],attrs:{name:"near",type:"number",min:t.near.min,max:t.near.max},domProps:{value:t.near.string},on:{input:[function(s){s.target.composing||t.$set(t.near,"string",s.target.value)},function(s){return t.handleInputChange(t.near)}]}})]),e("label",[t._v("far: "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.far.string,expression:"far.string"}],attrs:{name:"far",type:"number",min:t.far.min,max:t.far.max},domProps:{value:t.far.string},on:{input:[function(s){s.target.composing||t.$set(t.far,"string",s.target.value)},function(s){return t.handleInputChange(t.far)}]}})]),e("label",[t._v("catch: "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.allAtOnce,expression:"allAtOnce"}],staticStyle:{"font-family":"monospace"},on:{change:function(s){var e=Array.prototype.filter.call(s.target.options,(function(t){return t.selected})).map((function(t){var s="_value"in t?t._value:t.value;return s}));t.allAtOnce=s.target.multiple?e:e[0]}}},[e("option",{domProps:{value:!0}},[t._v("all ghosts in a cell at once")]),e("option",{domProps:{value:!1}},[t._v("one ghost at a time")])])]),e("Board",{attrs:{rows:t.rows.value,cols:t.cols.value,ghosts:t.ghosts.value,splits:[t.near.value,t.near.value+t.far.value],"all-at-once":t.allAtOnce}})],1)},a=[],l=(e("d3b7"),e("25f0"),function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{attrs:{id:"holder"}},[e("table",{staticClass:"center"},t._l(t.probabilities,(function(s,i){return e("tr",{key:i},t._l(s,(function(s,n){return e("td",{key:n,style:t.cellStyles(i,n,s),on:{click:function(s){return t.senseCell(i,n)}}},[t.tryResult>0&&i===t.lastSensed.x&&n===t.lastSensed.y?e("span",[1===t.tryResult?e("span",{style:{color:"green",fontSize:(t.allAtOnce?25:30)+"px"}},[t._v(" ✔"),t.allAtOnce?e("span",[t._v(t._s(t.caughtCount))]):t._e()]):2===t.tryResult?e("span",{staticStyle:{color:"red","font-size":"30px"}},[t._v(" ✗ ")]):t._e()]):e("span",[t._v(" "+t._s((100*s).toFixed(2))+" ")])])})),0)})),0),e("div",{attrs:{id:"caught"}},[t._v(" Caught Ghosts: "+t._s(t.ghosts-t.ghostPositions.length)+" ")]),0===t.ghostPositions.length?e("div",{attrs:{id:"done"}},[t._v(" "+t._s(1===t.ghosts?"Ghost":"All ghosts")+" caught, you can sleep at peace now. Yay! ")]):t._e(),e("div",{staticClass:"center",staticStyle:{width:"fit-content"}},[t.ghostPositions.length>0?e("button",{on:{click:t.advanceTime}},[t._v("Advance Time")]):t._e(),t.ghostPositions.length>0?e("button",{on:{click:t.reveal}},[t._v(t._s(t.revealed?"Hide":"Reveal"))]):t._e(),t.ghostPositions.length>0?e("button",{on:{click:t.catchMode}},[t._v(t._s(t.catching?"Find":"Catch"))]):t._e()])])}),h=[],u=(e("cb29"),e("4de4"),e("d81d"),e("13d5"),e("a434"),e("a9e3"),e("b85c")),c={name:"Board",props:{rows:{type:Number,default:9},cols:{type:Number,default:9},ghosts:{type:Number,default:1},splits:{type:Array,default:function(){return[2,7]}},allAtOnce:{type:Boolean,default:!0}},data:function(){return{bgColors:["red","orange","green"],fontColors:["white","black","white"],cornerProbabilities:[.48,.018,.004],sideProbabilities:[.32,.012,.004],midProbabilities:[.24,.009,.004],probabilities:[[]],ghostPositions:[],tryResult:0,caughtCount:0,lastSensed:{x:-1,y:-1},currentlySensed:[],revealed:!1,catching:!1}},methods:{initialize:function(){var t=this,s=this.rows*this.cols,e=this.ghosts/s;this.probabilities=Array(this.rows).fill(e).map((function(s){return Array(t.cols).fill(s)})),this.ghostPositions=Array(this.ghosts);for(var i=0;i<this.ghosts;i++)this.ghostPositions[i]=this.getRandomCell();this.tryResult=0,this.lastSensed={x:-1,y:-1},this.currentlySensed=[],this.catching=!1},cellStyles:function(t,s,e){if(this.tryResult>0&&t===this.lastSensed.x&&s===this.lastSensed.y)return{backgroundColor:"white"};if(this.isCurrentlySensed(t,s)||this.revealed){var i=this.getDistClass(this.closestGhostDistanceFromCell(t,s));return{backgroundColor:this.bgColors[i],color:this.fontColors[i]}}var n=0===this.ghostPositions.length?0:Math.sqrt(e/this.ghostPositions.length);return{backgroundColor:"rgba(0, 0, 255, ".concat(n,")"),color:n>.5?"white":"black"}},withinBoard:function(t,s){return t>=0&&t<this.rows&&s>=0&&s<this.cols},getRandomCell:function(){return{x:Math.floor(Math.random()*this.rows),y:Math.floor(Math.random()*this.cols)}},getDistClass:function(t){for(var s=0;s<this.splits.length;s++)if(t<=this.splits[s])return s;return this.splits.length},getDistClassCount:function(t,s,e){for(var i=0,n=0;n<this.rows;n++)for(var o=0;o<this.cols;o++)this.getDistClass(Math.abs(t-n)+Math.abs(s-o))===e&&i++;return i},ghostCountOfCell:function(t,s){return this.ghostPositions.reduce((function(e,i){return t===i.x&&s===i.y?++e:e}),0)},closestGhostDistanceFromCell:function(t,s){return this.ghostPositions.reduce((function(e,i){var n=i.x,o=i.y;return Math.min(e,Math.abs(n-t)+Math.abs(o-s))}),this.rows+this.cols)},isCornerCell:function(t,s){return(0===t||t===this.rows-1)&&(0===s||s===this.cols-1)},isMidCell:function(t,s){return t>0&&t<this.rows-1&&s>0&&s<this.cols-1},isSideCell:function(t,s){return!this.isCornerCell(t,s)&&!this.isMidCell(t,s)},getMoveProbabilities:function(t,s){return this.isCornerCell(t,s)?this.cornerProbabilities:this.isSideCell(t,s)?this.sideProbabilities:this.midProbabilities},updateArray:function(t,s,e,i){this.withinBoard(s,e)&&(t[s][e]+=i)},spreadSelf:function(t,s,e,i,n){this.updateArray(t,s+1,e,i*n[0]),this.updateArray(t,s-1,e,i*n[0]),this.updateArray(t,s,e+1,i*n[0]),this.updateArray(t,s,e-1,i*n[0]),this.updateArray(t,s+1,e+1,i*n[1]),this.updateArray(t,s+1,e-1,i*n[1]),this.updateArray(t,s-1,e+1,i*n[1]),this.updateArray(t,s-1,e-1,i*n[1]),this.updateArray(t,s,e,i*n[2])},advanceProbabilities:function(){for(var t=this,s=Array(this.rows).fill(0).map((function(s){return Array(t.cols).fill(s)})),e=0;e<this.rows;e++)for(var i=0;i<this.cols;i++)this.spreadSelf(s,e,i,this.probabilities[e][i],this.getMoveProbabilities(e,i));this.probabilities=s},goRandomDirection:function(t){var s=t.x,e=t.y,i=this.getMoveProbabilities(s,e),n=Math.random(),o=0;return this.withinBoard(s+1,e)&&(o+=i[0],n<o)?{x:s+1,y:e}:this.withinBoard(s-1,e)&&(o+=i[0],n<o)?{x:s-1,y:e}:this.withinBoard(s,e+1)&&(o+=i[0],n<o)?{x:s,y:e+1}:this.withinBoard(s,e-1)&&(o+=i[0],n<o)?{x:s,y:e-1}:this.withinBoard(s+1,e+1)&&(o+=i[1],n<o)?{x:s+1,y:e+1}:this.withinBoard(s+1,e-1)&&(o+=i[1],n<o)?{x:s+1,y:e-1}:this.withinBoard(s-1,e+1)&&(o+=i[1],n<o)?{x:s-1,y:e+1}:this.withinBoard(s-1,e-1)&&(o+=i[1],n<o)?{x:s-1,y:e-1}:{x:s,y:e}},advanceGhosts:function(){for(var t=0;t<this.ghostPositions.length;t++)this.$set(this.ghostPositions,t,this.goRandomDirection(this.ghostPositions[t]))},advanceTime:function(){this.currentlySensed=[],this.advanceProbabilities(),this.advanceGhosts()},updateCell:function(t,s,e){this.probabilities[t][s]=e,this.$set(this.probabilities,t,this.probabilities[t])},tryToCatch:function(t,s){var e=this;if(this.caughtCount=this.ghostCountOfCell(t,s),this.caughtCount>0){if(this.allAtOnce||(this.caughtCount=1),this.currentlySensed=[],this.allAtOnce)this.ghostPositions=this.ghostPositions.filter((function(e){return t!==e.x||s!==e.y})),this.updateCell(t,s,0);else for(var i=0;i<this.ghostPositions.length;i++)if(this.ghostPositions[i].x===t&&this.ghostPositions[i].y===s){this.ghostPositions.splice(i,1);break}this.normalize(),0===this.ghostPositions.length&&(this.probabilities=Array(this.rows).fill(0).map((function(t){return Array(e.cols).fill(t)}))),this.tryResult=1,setTimeout((function(){e.tryResult=0}),1e3)}else this.updateCell(t,s,0),this.normalize(),this.tryResult=2,setTimeout((function(){e.tryResult=0}),500)},reWeight:function(t,s){for(var e=this.getDistClass(this.closestGhostDistanceFromCell(t,s)),i=0,n=0;n<e;n++)i+=this.getDistClassCount(t,s,n);for(var o=this.getDistClassCount(t,s,e),r=this.rows*this.cols,a=Math.pow(r,this.ghostPositions.length),l=Math.pow(r-1,this.ghostPositions.length),h=Math.pow(r-i,this.ghostPositions.length),u=Math.pow(r-i-1,this.ghostPositions.length),c=Math.pow(r-i-o,this.ghostPositions.length),g=Math.pow(r-i-o-1,this.ghostPositions.length),f=(h-u)/(a-l),d=(h-u-c+g)/(a-l),p=JSON.parse(JSON.stringify(this.probabilities)),m=0;m<this.rows;m++)for(var v=0;v<this.cols;v++){var b=this.getDistClass(Math.abs(t-m)+Math.abs(s-v));b<e?p[m][v]=0:p[m][v]*=b===e?f:d}this.probabilities=p},normalize:function(){var t=this.probabilities.reduce((function(t,s){return t+s.reduce((function(t,s){return t+s}),0)}),0);t/=this.ghostPositions.length;for(var s=JSON.parse(JSON.stringify(this.probabilities)),e=0;e<this.rows;e++)for(var i=0;i<this.cols;i++)s[e][i]/=t;this.probabilities=s},senseCell:function(t,s){this.tryResult>0||0===this.ghostPositions.length||(this.lastSensed={x:t,y:s},this.catching?this.tryToCatch(t,s):this.isCurrentlySensed(t,s)||(this.currentlySensed.push({x:t,y:s}),this.reWeight(t,s),this.normalize()))},isCurrentlySensed:function(t,s){var e,i=Object(u["a"])(this.currentlySensed);try{for(i.s();!(e=i.n()).done;){var n=e.value;if(t===n.x&&s===n.y)return!0}}catch(o){i.e(o)}finally{i.f()}return!1},reveal:function(){this.revealed=!this.revealed},catchMode:function(){this.currentlySensed=[],this.catching=!this.catching}},watch:{rows:function(){this.initialize()},cols:function(){this.initialize()},ghosts:function(){this.initialize()},splits:function(){this.currentlySensed=[]}},created:function(){this.initialize()}},g=c,f=(e("87db"),e("2877")),d=Object(f["a"])(g,l,h,!1,null,"24734e9e",null),p=d.exports,m={name:"Game",components:{Board:p},data:function(){return{rows:{string:"9",value:9,min:1,max:10},cols:{string:"9",value:9,min:1,max:20},ghosts:{string:"1",value:1,min:1,max:10},near:{string:"2",value:2,min:0,max:3},far:{string:"3",value:3,min:0,max:5},allAtOnce:!0}},methods:{handleInputChange:function(t){if(""===t.string)this.$set(t,"value",t.min);else{var s=Math.max(t.min,Math.min(t.max,parseInt(t.string)));this.$set(t,"value",s),this.$set(t,"string",s.toString())}}}},v=m,b=(e("6e53"),Object(f["a"])(v,r,a,!1,null,"6a6a5d8a",null)),y=b.exports,w={name:"App",components:{Game:y}},C=w,x=(e("034f"),Object(f["a"])(C,n,o,!1,null,null,null)),P=x.exports;i["a"].config.productionTip=!1,new i["a"]({render:function(t){return t(P)}}).$mount("#app")},"6e53":function(t,s,e){"use strict";e("86c5")},"85ec":function(t,s,e){},"86c5":function(t,s,e){},"87db":function(t,s,e){"use strict";e("9f2e")},"9f2e":function(t,s,e){}});
//# sourceMappingURL=app.1565b2df.js.map